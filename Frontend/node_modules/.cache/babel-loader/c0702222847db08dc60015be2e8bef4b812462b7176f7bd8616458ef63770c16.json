{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\cheta\\\\OneDrive\\\\Desktop\\\\Hackathon\\\\Frontend\\\\src\\\\component\\\\booking_rooms\\\\RoomDetailsPage.jsx\",\n  _s = $RefreshSig$();\n// RoomDetailsPage.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ApiService from '../../service/ApiService';\nimport DatePicker from 'react-datepicker';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport moment from 'moment';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RoomDetailsPage = () => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    roomId\n  } = useParams();\n  const [roomDetails, setRoomDetails] = useState({\n    bookings: []\n  });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [checkInDate, setCheckInDate] = useState(null);\n  const [showDatePicker, setShowDatePicker] = useState(false);\n  const [userId, setUserId] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [showMessage, setShowMessage] = useState(false);\n  const [confirmationCode, setConfirmationCode] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [availableTimeSlots, setAvailableTimeSlots] = useState([]);\n  const [bookedSlotLabels, setBookedSlotLabels] = useState([]);\n  const [startSlotLabel, setStartSlotLabel] = useState('');\n  const [endSlotLabel, setEndSlotLabel] = useState('');\n  const [selectedSlots, setSelectedSlots] = useState([]);\n  const [alreadyBookedDetails, setAlreadyBookedDetails] = useState([]);\n  useEffect(() => {\n    const slots = [];\n    let start = moment('08:00', 'HH:mm');\n    const end = moment('19:00', 'HH:mm');\n    let id = 1;\n    while (start < end) {\n      const next = moment(start).add(30, 'minutes');\n      slots.push({\n        id: id++,\n        label: `${start.format('hh:mm A')} - ${next.format('hh:mm A')}`,\n        startTime: start.format('HH:mm'),\n        endTime: next.format('HH:mm')\n      });\n      start = next;\n    }\n    setAvailableTimeSlots(slots);\n  }, []);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setIsLoading(true);\n        const response = await ApiService.getRoomById(roomId);\n        const roomData = {\n          ...response.room,\n          bookings: response.room.bookings || []\n        };\n        setRoomDetails(roomData);\n        const userProfile = await ApiService.getUserProfile();\n        setUserId(userProfile.user.id);\n        setUserEmail(userProfile.user.email);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        setError(((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    if (roomId) fetchData();\n  }, [roomId]);\n  useEffect(() => {\n    if (checkInDate && Array.isArray(roomDetails.bookings)) {\n      const selectedDate = moment(checkInDate).format('YYYY-MM-DD');\n      const bookedSlots = roomDetails.bookings.filter(b => b.checkInDate === selectedDate).flatMap(b => Array.isArray(b.timeSlots) ? b.timeSlots : []);\n      const labels = bookedSlots.map(slot => slot.label);\n      setBookedSlotLabels(labels);\n      const bookedDetails = roomDetails.bookings.filter(b => b.checkInDate === selectedDate).map(b => ({\n        checkInDate: b.checkInDate,\n        timeSlots: Array.isArray(b.timeSlots) ? b.timeSlots : []\n      }));\n      setAlreadyBookedDetails(bookedDetails);\n    } else {\n      setBookedSlotLabels([]);\n      setAlreadyBookedDetails([]);\n    }\n  }, [checkInDate, roomDetails]);\n  useEffect(() => {\n    if (startSlotLabel && endSlotLabel && Array.isArray(availableTimeSlots)) {\n      const startIndex = availableTimeSlots.findIndex(s => s.label === startSlotLabel);\n      const endIndex = availableTimeSlots.findIndex(s => s.label === endSlotLabel);\n      if (startIndex <= endIndex && startIndex !== -1 && endIndex !== -1) {\n        const selectedDateStr = moment(checkInDate).format('YYYY-MM-DD');\n        const now = moment();\n        const isToday = selectedDateStr === now.format('YYYY-MM-DD');\n        const rangeSlots = availableTimeSlots.slice(startIndex, endIndex + 1).filter(slot => {\n          const [startTime] = slot.label.split(' - ');\n          const slotMoment = moment(`${selectedDateStr} ${startTime}`, 'YYYY-MM-DD hh:mm A');\n          return !bookedSlotLabels.includes(slot.label) && (!isToday || slotMoment.isSameOrAfter(now));\n        });\n        setSelectedSlots(rangeSlots);\n      } else {\n        setSelectedSlots([]);\n      }\n    } else {\n      setSelectedSlots([]);\n    }\n  }, [startSlotLabel, endSlotLabel, checkInDate, availableTimeSlots, bookedSlotLabels]);\n  const sendBookingEmail = async code => {\n    try {\n      await ApiService.sendBookingConfirmationEmail(userEmail, {\n        roomType: roomDetails.roomType,\n        checkInDate: moment(checkInDate).format('DD/MM/YYYY'),\n        timeSlots: selectedSlots.map(s => s.label),\n        confirmationCode: code\n      });\n    } catch (e) {\n      console.error('Failed to send email:', e.message);\n    }\n  };\n  const acceptBooking = async () => {\n    if (!checkInDate) {\n      setErrorMessage('Please select a check-in date.');\n      return;\n    }\n    if (selectedSlots.length === 0) {\n      setErrorMessage('Please select a valid time slot range.');\n      return;\n    }\n    try {\n      const latestRoom = await ApiService.getRoomById(roomId);\n      const selectedDate = moment(checkInDate).format('YYYY-MM-DD');\n      const latestBookings = Array.isArray(latestRoom.room.bookings) ? latestRoom.room.bookings : [];\n      const alreadyBookedLabels = latestBookings.filter(b => b.checkInDate === selectedDate).flatMap(b => Array.isArray(b.timeSlots) ? b.timeSlots : []).map(slot => slot.label);\n      const isConflict = selectedSlots.some(slot => alreadyBookedLabels.includes(slot.label));\n      if (isConflict) {\n        setErrorMessage('Selected time slot is already booked. Please choose a different range.');\n        setTimeout(() => setErrorMessage(''), 1500);\n        return;\n      }\n      const booking = {\n        checkInDate: selectedDate,\n        timeSlotIds: selectedSlots.map(slot => slot.id)\n      };\n      const response = await ApiService.bookRoom(roomId, userId, booking);\n      if (response.statusCode === 200) {\n        const code = response.bookingConfirmationCode;\n        setConfirmationCode(code);\n        setShowMessage(true);\n        setErrorMessage('');\n        setSelectedSlots([]);\n        setStartSlotLabel('');\n        setEndSlotLabel('');\n        await sendBookingEmail(code);\n        setTimeout(() => {\n          setShowMessage(false);\n          navigate('/rooms');\n        }, 1000);\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      const msg = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message;\n      setErrorMessage(msg);\n      console.error('Booking failed:', error);\n    }\n  };\n  if (isLoading) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"loading\",\n    children: \"Loading room details...\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 190,\n    columnNumber: 25\n  }, this);\n  if (error) return /*#__PURE__*/_jsxDEV(\"p\", {\n    className: \"error-message\",\n    children: error\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 191,\n    columnNumber: 21\n  }, this);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"room-details-booking\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      className: \"room-title\",\n      children: \"Room Booking\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"room-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: roomDetails === null || roomDetails === void 0 ? void 0 : roomDetails.roomPhotoUrl,\n        alt: roomDetails === null || roomDetails === void 0 ? void 0 : roomDetails.roomType,\n        className: \"room-image\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"room-info\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          children: roomDetails === null || roomDetails === void 0 ? void 0 : roomDetails.roomType\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: roomDetails === null || roomDetails === void 0 ? void 0 : roomDetails.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"booking-panel\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setShowDatePicker(true),\n        className: \"primary-btn\",\n        children: \"Book Now\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => navigate('/rooms'),\n        className: \"secondary-btn\",\n        children: \"Go Back\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), showDatePicker && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"booking-form\",\n        children: [/*#__PURE__*/_jsxDEV(DatePicker, {\n          selected: checkInDate,\n          onChange: date => {\n            setCheckInDate(date);\n            setStartSlotLabel('');\n            setEndSlotLabel('');\n            setSelectedSlots([]);\n          },\n          placeholderText: \"Select Check-in Date\",\n          dateFormat: \"dd/MM/yyyy\",\n          minDate: new Date(),\n          className: \"datepicker-field\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 13\n        }, this), checkInDate && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"slot-row-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"slot-left-panel\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dropdown-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"Start Time:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: startSlotLabel,\n                onChange: e => setStartSlotLabel(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"-- Select Start Time --\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 231,\n                  columnNumber: 23\n                }, this), availableTimeSlots.map((slot, idx) => /*#__PURE__*/_jsxDEV(\"option\", {\n                  value: slot.label,\n                  disabled: bookedSlotLabels.includes(slot.label),\n                  children: [slot.label, \" \", bookedSlotLabels.includes(slot.label) ? '(Booked)' : '']\n                }, idx, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 233,\n                  columnNumber: 25\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 230,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 228,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"dropdown-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n                children: \"End Time:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 241,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n                value: endSlotLabel,\n                onChange: e => setEndSlotLabel(e.target.value),\n                children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                  value: \"\",\n                  children: \"-- Select End Time --\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 243,\n                  columnNumber: 23\n                }, this), availableTimeSlots.map((slot, idx) => {\n                  const isBooked = bookedSlotLabels.includes(slot.label);\n                  const startIndex = availableTimeSlots.findIndex(s => s.label === startSlotLabel);\n                  const currentIndex = idx;\n                  const isInvalidRange = startSlotLabel && currentIndex < startIndex;\n                  return /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: slot.label,\n                    disabled: isBooked || isInvalidRange,\n                    children: [slot.label, \" \", isBooked ? '(Booked)' : '']\n                  }, idx, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 250,\n                    columnNumber: 27\n                  }, this);\n                })]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 19\n            }, this), startSlotLabel && endSlotLabel && selectedSlots.length === 0 && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"warning-text\",\n              style: {\n                color: 'red'\n              },\n              children: \"\\u26A0\\uFE0F No available time slots in the selected range.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 21\n            }, this), selectedSlots.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"slot-summary\",\n              children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n                children: \"Selected Time Slots:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 266,\n                columnNumber: 23\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                children: selectedSlots.map((slot, index) => /*#__PURE__*/_jsxDEV(\"li\", {\n                  className: \"selected-slot\",\n                  children: slot.label\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 27\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 267,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: acceptBooking,\n              className: \"confirm-booking\",\n              disabled: !checkInDate || selectedSlots.length === 0 || !startSlotLabel || !endSlotLabel,\n              children: \"Confirm Booking\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 276,\n              columnNumber: 19\n            }, this), errorMessage && /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"error-text\",\n              style: {\n                color: 'red'\n              },\n              children: errorMessage\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 36\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 17\n          }, this), alreadyBookedDetails.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"booked-slots-section\",\n            children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n              children: \"Already Booked:\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 21\n            }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 293,\n              columnNumber: 45\n            }, this), alreadyBookedDetails.map((booking, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n              children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Check-in Date:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 296,\n                  columnNumber: 28\n                }, this), \" \", booking.checkInDate]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 296,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n                  children: \"Time Slots:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 28\n                }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 297,\n                  columnNumber: 56\n                }, this), (booking.timeSlots || []).map((slot, i) => /*#__PURE__*/_jsxDEV(\"span\", {\n                  children: [slot.startTime, \" - \", slot.endTime, /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 299,\n                    columnNumber: 76\n                  }, this)]\n                }, i, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 299,\n                  columnNumber: 29\n                }, this))]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 297,\n                columnNumber: 25\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 301,\n                columnNumber: 29\n              }, this)]\n            }, idx, true, {\n              fileName: _jsxFileName,\n              lineNumber: 295,\n              columnNumber: 23\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 292,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 205,\n      columnNumber: 7\n    }, this), showMessage && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"success-banner bottom-toast\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"\\uD83D\\uDE03 Booking successful! Confirmation Code: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n          children: confirmationCode\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 56\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 314,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 194,\n    columnNumber: 5\n  }, this);\n};\n_s(RoomDetailsPage, \"6THBJFP5Qvnge8o8mhZ/0dSfbXk=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = RoomDetailsPage;\nexport default RoomDetailsPage;\nvar _c;\n$RefreshReg$(_c, \"RoomDetailsPage\");","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","ApiService","DatePicker","moment","jsxDEV","_jsxDEV","RoomDetailsPage","_s","navigate","roomId","roomDetails","setRoomDetails","bookings","isLoading","setIsLoading","error","setError","checkInDate","setCheckInDate","showDatePicker","setShowDatePicker","userId","setUserId","userEmail","setUserEmail","showMessage","setShowMessage","confirmationCode","setConfirmationCode","errorMessage","setErrorMessage","availableTimeSlots","setAvailableTimeSlots","bookedSlotLabels","setBookedSlotLabels","startSlotLabel","setStartSlotLabel","endSlotLabel","setEndSlotLabel","selectedSlots","setSelectedSlots","alreadyBookedDetails","setAlreadyBookedDetails","slots","start","end","id","next","add","push","label","format","startTime","endTime","fetchData","response","getRoomById","roomData","room","userProfile","getUserProfile","user","email","_error$response","_error$response$data","data","message","Array","isArray","selectedDate","bookedSlots","filter","b","flatMap","timeSlots","labels","map","slot","bookedDetails","startIndex","findIndex","s","endIndex","selectedDateStr","now","isToday","rangeSlots","slice","split","slotMoment","includes","isSameOrAfter","sendBookingEmail","code","sendBookingConfirmationEmail","roomType","e","console","acceptBooking","length","latestRoom","latestBookings","alreadyBookedLabels","isConflict","some","setTimeout","booking","timeSlotIds","bookRoom","statusCode","bookingConfirmationCode","_error$response2","_error$response2$data","msg","className","children","fileName","_jsxFileName","lineNumber","columnNumber","src","roomPhotoUrl","alt","description","onClick","selected","onChange","date","placeholderText","dateFormat","minDate","Date","value","target","idx","disabled","isBooked","currentIndex","isInvalidRange","style","color","index","i","_c","$RefreshReg$"],"sources":["C:/Users/cheta/OneDrive/Desktop/Hackathon/Frontend/src/component/booking_rooms/RoomDetailsPage.jsx"],"sourcesContent":["// RoomDetailsPage.jsx\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport ApiService from '../../service/ApiService';\nimport DatePicker from 'react-datepicker';\nimport 'react-datepicker/dist/react-datepicker.css';\nimport moment from 'moment';\n\nconst RoomDetailsPage = () => {\n  const navigate = useNavigate();\n  const { roomId } = useParams();\n\n  const [roomDetails, setRoomDetails] = useState({ bookings: [] });\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [checkInDate, setCheckInDate] = useState(null);\n  const [showDatePicker, setShowDatePicker] = useState(false);\n  const [userId, setUserId] = useState('');\n  const [userEmail, setUserEmail] = useState('');\n  const [showMessage, setShowMessage] = useState(false);\n  const [confirmationCode, setConfirmationCode] = useState('');\n  const [errorMessage, setErrorMessage] = useState('');\n  const [availableTimeSlots, setAvailableTimeSlots] = useState([]);\n  const [bookedSlotLabels, setBookedSlotLabels] = useState([]);\n  const [startSlotLabel, setStartSlotLabel] = useState('');\n  const [endSlotLabel, setEndSlotLabel] = useState('');\n  const [selectedSlots, setSelectedSlots] = useState([]);\n  const [alreadyBookedDetails, setAlreadyBookedDetails] = useState([]);\n\n  useEffect(() => {\n    const slots = [];\n    let start = moment('08:00', 'HH:mm');\n    const end = moment('19:00', 'HH:mm');\n    let id = 1;\n    while (start < end) {\n      const next = moment(start).add(30, 'minutes');\n      slots.push({\n        id: id++,\n        label: `${start.format('hh:mm A')} - ${next.format('hh:mm A')}`,\n        startTime: start.format('HH:mm'),\n        endTime: next.format('HH:mm'),\n      });\n      start = next;\n    }\n    setAvailableTimeSlots(slots);\n  }, []);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        setIsLoading(true);\n        const response = await ApiService.getRoomById(roomId);\n        const roomData = {\n          ...response.room,\n          bookings: response.room.bookings || [],\n        };\n        setRoomDetails(roomData);\n\n        const userProfile = await ApiService.getUserProfile();\n        setUserId(userProfile.user.id);\n        setUserEmail(userProfile.user.email);\n      } catch (error) {\n        setError(error.response?.data?.message || error.message);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    if (roomId) fetchData();\n  }, [roomId]);\n\n  useEffect(() => {\n    if (checkInDate && Array.isArray(roomDetails.bookings)) {\n      const selectedDate = moment(checkInDate).format('YYYY-MM-DD');\n      const bookedSlots = roomDetails.bookings\n        .filter((b) => b.checkInDate === selectedDate)\n        .flatMap((b) => Array.isArray(b.timeSlots) ? b.timeSlots : []);\n\n      const labels = bookedSlots.map((slot) => slot.label);\n      setBookedSlotLabels(labels);\n\n      const bookedDetails = roomDetails.bookings\n        .filter((b) => b.checkInDate === selectedDate)\n        .map((b) => ({\n          checkInDate: b.checkInDate,\n          timeSlots: Array.isArray(b.timeSlots) ? b.timeSlots : [],\n        }));\n\n      setAlreadyBookedDetails(bookedDetails);\n    } else {\n      setBookedSlotLabels([]);\n      setAlreadyBookedDetails([]);\n    }\n  }, [checkInDate, roomDetails]);\n\n  useEffect(() => {\n    if (startSlotLabel && endSlotLabel && Array.isArray(availableTimeSlots)) {\n      const startIndex = availableTimeSlots.findIndex((s) => s.label === startSlotLabel);\n      const endIndex = availableTimeSlots.findIndex((s) => s.label === endSlotLabel);\n\n      if (startIndex <= endIndex && startIndex !== -1 && endIndex !== -1) {\n        const selectedDateStr = moment(checkInDate).format('YYYY-MM-DD');\n        const now = moment();\n        const isToday = selectedDateStr === now.format('YYYY-MM-DD');\n\n        const rangeSlots = availableTimeSlots.slice(startIndex, endIndex + 1).filter((slot) => {\n          const [startTime] = slot.label.split(' - ');\n          const slotMoment = moment(`${selectedDateStr} ${startTime}`, 'YYYY-MM-DD hh:mm A');\n          return !bookedSlotLabels.includes(slot.label) && (!isToday || slotMoment.isSameOrAfter(now));\n        });\n\n        setSelectedSlots(rangeSlots);\n      } else {\n        setSelectedSlots([]);\n      }\n    } else {\n      setSelectedSlots([]);\n    }\n  }, [startSlotLabel, endSlotLabel, checkInDate, availableTimeSlots, bookedSlotLabels]);\n\n  const sendBookingEmail = async (code) => {\n    try {\n      await ApiService.sendBookingConfirmationEmail(userEmail, {\n        roomType: roomDetails.roomType,\n        checkInDate: moment(checkInDate).format('DD/MM/YYYY'),\n        timeSlots: selectedSlots.map((s) => s.label),\n        confirmationCode: code,\n      });\n    } catch (e) {\n      console.error('Failed to send email:', e.message);\n    }\n  };\n\n  const acceptBooking = async () => {\n    if (!checkInDate) {\n      setErrorMessage('Please select a check-in date.');\n      return;\n    }\n\n    if (selectedSlots.length === 0) {\n      setErrorMessage('Please select a valid time slot range.');\n      return;\n    }\n\n    try {\n      const latestRoom = await ApiService.getRoomById(roomId);\n      const selectedDate = moment(checkInDate).format('YYYY-MM-DD');\n      const latestBookings = Array.isArray(latestRoom.room.bookings) ? latestRoom.room.bookings : [];\n\n      const alreadyBookedLabels = latestBookings\n        .filter((b) => b.checkInDate === selectedDate)\n        .flatMap((b) => Array.isArray(b.timeSlots) ? b.timeSlots : [])\n        .map((slot) => slot.label);\n\n      const isConflict = selectedSlots.some((slot) => alreadyBookedLabels.includes(slot.label));\n      if (isConflict) {\n        setErrorMessage('Selected time slot is already booked. Please choose a different range.');\n        setTimeout(() => setErrorMessage(''), 1500);\n        return;\n      }\n\n      const booking = {\n        checkInDate: selectedDate,\n        timeSlotIds: selectedSlots.map((slot) => slot.id),\n      };\n\n      const response = await ApiService.bookRoom(roomId, userId, booking);\n\n      if (response.statusCode === 200) {\n        const code = response.bookingConfirmationCode;\n        setConfirmationCode(code);\n        setShowMessage(true);\n        setErrorMessage('');\n        setSelectedSlots([]);\n        setStartSlotLabel('');\n        setEndSlotLabel('');\n        await sendBookingEmail(code);\n\n        setTimeout(() => {\n          setShowMessage(false);\n          navigate('/rooms');\n        }, 1000);\n      }\n    } catch (error) {\n      const msg = error.response?.data?.message || error.message;\n      setErrorMessage(msg);\n      console.error('Booking failed:', error);\n    }\n  };\n\n  if (isLoading) return <p className=\"loading\">Loading room details...</p>;\n  if (error) return <p className=\"error-message\">{error}</p>;\n\n  return (\n    <div className=\"room-details-booking\">\n      <h1 className=\"room-title\">Room Booking</h1>\n\n      <div className=\"room-card\">\n        <img src={roomDetails?.roomPhotoUrl} alt={roomDetails?.roomType} className=\"room-image\" />\n        <div className=\"room-info\">\n          <h2>{roomDetails?.roomType}</h2>\n          <p>{roomDetails?.description}</p>\n        </div>\n      </div>\n\n      <div className=\"booking-panel\">\n        <button onClick={() => setShowDatePicker(true)} className=\"primary-btn\">Book Now</button>\n        <button onClick={() => navigate('/rooms')} className=\"secondary-btn\">Go Back</button>\n\n        {showDatePicker && (\n          <div className=\"booking-form\">\n            <DatePicker\n              selected={checkInDate}\n              onChange={(date) => {\n                setCheckInDate(date);\n                setStartSlotLabel('');\n                setEndSlotLabel('');\n                setSelectedSlots([]);\n              }}\n              placeholderText=\"Select Check-in Date\"\n              dateFormat=\"dd/MM/yyyy\"\n              minDate={new Date()}\n              className=\"datepicker-field\"\n            />\n\n            {checkInDate && (\n              <div className=\"slot-row-container\">\n                <div className=\"slot-left-panel\">\n                  <div className=\"dropdown-section\">\n                    <br /><label>Start Time:</label>\n                    <select value={startSlotLabel} onChange={(e) => setStartSlotLabel(e.target.value)}>\n                      <option value=\"\">-- Select Start Time --</option>\n                      {availableTimeSlots.map((slot, idx) => (\n                        <option key={idx} value={slot.label} disabled={bookedSlotLabels.includes(slot.label)}>\n                          {slot.label} {bookedSlotLabels.includes(slot.label) ? '(Booked)' : ''}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n\n                  <div className=\"dropdown-section\">\n                    <br /><label>End Time:</label>\n                    <select value={endSlotLabel} onChange={(e) => setEndSlotLabel(e.target.value)}>\n                      <option value=\"\">-- Select End Time --</option>\n                      {availableTimeSlots.map((slot, idx) => {\n                        const isBooked = bookedSlotLabels.includes(slot.label);\n                        const startIndex = availableTimeSlots.findIndex((s) => s.label === startSlotLabel);\n                        const currentIndex = idx;\n                        const isInvalidRange = startSlotLabel && currentIndex < startIndex;\n                        return (\n                          <option key={idx} value={slot.label} disabled={isBooked || isInvalidRange}>\n                            {slot.label} {isBooked ? '(Booked)' : ''}\n                          </option>\n                        );\n                      })}\n                    </select>\n                  </div>\n\n                  {startSlotLabel && endSlotLabel && selectedSlots.length === 0 && (\n                    <p className=\"warning-text\" style={{ color: 'red' }}>\n                      ‚ö†Ô∏è No available time slots in the selected range.\n                    </p>\n                  )}\n\n                  {selectedSlots.length > 0 && (\n                    <div className=\"slot-summary\">\n                      <h4>Selected Time Slots:</h4>\n                      <ul>\n                        {selectedSlots.map((slot, index) => (\n                          <li key={index} className=\"selected-slot\">{slot.label}</li>\n                        ))}\n                      </ul>\n                    </div>\n                  )}\n\n                  <br />\n                  <button\n                    onClick={acceptBooking}\n                    className=\"confirm-booking\"\n                    disabled={\n                      !checkInDate ||\n                      selectedSlots.length === 0 ||\n                      !startSlotLabel ||\n                      !endSlotLabel\n                    }\n                  >\n                    Confirm Booking\n                  </button>\n                  {errorMessage && <p className=\"error-text\" style={{ color: 'red' }}>{errorMessage}</p>}\n                </div>\n\n                {alreadyBookedDetails.length > 0 && (\n                  <div className=\"booked-slots-section\">\n                    <h4>Already Booked:</h4><br />\n                    {alreadyBookedDetails.map((booking, idx) => (\n                      <div key={idx}>\n                        <p><strong>Check-in Date:</strong> {booking.checkInDate}</p>\n                        <p><strong>Time Slots:</strong><br />\n                          {(booking.timeSlots || []).map((slot, i) => (\n                            <span key={i}>{slot.startTime} - {slot.endTime}<br /></span>\n                          ))}\n                        </p><br />\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {showMessage && (\n        <div className=\"success-banner bottom-toast\">\n          <p>üòÉ Booking successful! Confirmation Code: <strong>{confirmationCode}</strong></p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default RoomDetailsPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}